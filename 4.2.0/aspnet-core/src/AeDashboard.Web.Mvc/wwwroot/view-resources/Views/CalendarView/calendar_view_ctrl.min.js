(function(){"use strict";function n(n,t,i,r,u,f){function h(){i.load=0;localStorage.removeItem("count");moment().locale("vi");o(0,32);l();try{i.week=(new Date).getFullYear()+"-W"+f.getWeek(new Date)}catch(n){}}function c(){r.location.reload()}function l(){$(window).scroll(function(){var n=$(document).height()-$(window).height()-$(window).scrollTop(),t=!1,u,r;if(n>=0&&n<=9&&(t=!0),n>=400&&n<=410&&(t=!0),n>=300&&n<=310&&(t=!0),n>=50&&n<=60&&(t=!0),n>=100&&n<=110&&(t=!0),n>=150&&n<=160&&(t=!0),n>=200&&n<=210&&(t=!0),t){u=5;r=0;try{r=localStorage.getItem("count")}catch(f){r=0}switch(i.load){case 0:o(r,u);i.load=0;break;case 3:e(r,u,i.searchDate)}}})}function a(n,r,u){var e={Skip:n,Take:r,Week:u};t.get("/Calendar/SearchWeek",{params:e}).then(function(n){i.getAll=n.data.result;setTimeout(function(){f.setColspan()},100)})}function e(n,r,u){var e={Skip:n,Take:r,Search:u};t.get("/Calendar/SearchName",{params:e}).then(function(n){if(sessionStorage.searchname==null)i.getAll=n.data.result,sessionStorage.searchname=n.data.result.length;else{for(var t=0;t<n.data.result.length;t++)i.getAll.push(n.data.result[t]);sessionStorage.searchname=n.data.result.length}setTimeout(function(){f.setColspan()},100)})}function v(n,r,u){var e={Skip:n,Take:r,Date:u};t.get("/Calendar/SearchDate",{params:e}).then(function(n){i.getAll=n.data.result;setTimeout(function(){f.setColspan()},100)})}function o(n,r){var u={Skip:n,Take:r};t.get("/Calendar/GetLoads",{params:u}).then(function(n){if(r==0)i.getAll=n.data.result,localStorage.setItem("count",i.getAll.length);else{for(var t=0;t<n.data.result.length;t++)i.getAll.push(n.data.result[t]);localStorage.setItem("count",i.getAll.length)}setTimeout(function(){f.setColspan()},100)})}var s=this;i.getAll=[];s.title="calendar_view_ctrl";h();i.$watch("week",function(){if(i.load==2){var n=u("date")(i.week,"yyyyWww");a(0,0,n)}i.load!=2&&(i.load=2)});i.$watch("searchDate",function(){if(i.load==1){var n=i.searchDate;v(0,0,n)}i.load!=1&&(i.load=1)});i.$watch("searchName",function(){if(console.log("serchNem"+sessionStorage.searchname+"     "+i.load),sessionStorage.searchname=null,i.load==3){var n=i.searchName;e(0,32,n)}i.load!=3&&(i.load=3)});i.hoverIn=function(){this.hoverEdit="show"};i.formatDate=function(n){return f.formatDate(n,1)};i.hoverOut=function(){this.hoverEdit="hide"};i.showEdit=function(){};i.edit_caladarView=function(n){var i="/Calendar/EditCalendarViewModal?id="+n;t.get(i).then(function(n){$("#editCalendarView div.modal-body").html(n.data)})};i.delete_item=function(n){var i="/Calendar/Delete?id="+n;t.get(i).then(function(){c()})};i.showBtns=function(){}}app.controller("ctrl",n);n.$inject=["$location","$http","$scope","$window","$filter","factory"]})();